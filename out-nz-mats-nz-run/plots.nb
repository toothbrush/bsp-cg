(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     16930,        508]
NotebookOptionsPosition[     15924,        468]
NotebookOutlinePosition[     16261,        483]
CellTagsIndexPosition[     16218,        480]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<PlotLegends`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"data", "=", 
  RowBox[{
  "Import", "[", "\"\<~/univ/bsp-cg/out-nz-mats-nz-run/data.csv\>\"", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.535879474214962*^9, 3.535879493109467*^9}, {
  3.53588026629847*^9, 3.53588027561584*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2", ",", "1000", ",", "106342", ",", "0.036735`", ",", "12", ",", "1"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "1000", ",", "223034", ",", "0.04802`", ",", "11", ",", "1"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "2000", ",", "423252", ",", "0.088295`", ",", "11", ",", "1"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "2000", ",", "889372", ",", "0.125819`", ",", "10", ",", "1"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "3000", ",", "950022", ",", "0.149972`", ",", "10", ",", "1"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "3000", ",", "2001058", ",", "0.256741`", ",", "10", ",", "1"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "4000", ",", "1689062", ",", "0.270121`", ",", "11", ",", "1"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "4000", ",", "3555962", ",", "0.430178`", ",", "10", ",", "1"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "5657", ",", "7110505", ",", "0.794377`", ",", "10", ",", "1"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "6000", ",", "3797120", ",", "0.492455`", ",", "10", ",", "1"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "8000", ",", "6745868", ",", "0.841319`", ",", "10", ",", "1"}],
     "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5358798558536654`*^9, {3.5358802669794703`*^9, 3.535880277195676*^9}, 
   3.5358811814204493`*^9, 3.535881821312005*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2", ",", "1000", ",", "106342", ",", "0.036735`", ",", "12", ",", "1"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "1000", ",", "223034", ",", "0.04802`", ",", "11", ",", "1"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "2000", ",", "423252", ",", "0.088295`", ",", "11", ",", "1"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "2000", ",", "889372", ",", "0.125819`", ",", "10", ",", "1"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "3000", ",", "950022", ",", "0.149972`", ",", "10", ",", "1"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "3000", ",", "2001058", ",", "0.256741`", ",", "10", ",", "1"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "4000", ",", "1689062", ",", "0.270121`", ",", "11", ",", "1"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "4000", ",", "3555962", ",", "0.430178`", ",", "10", ",", "1"}],
     "}"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.535879519323461*^9, 3.5358795205025673`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2", ",", "1000", ",", "106342", ",", "0.036735`", ",", "12", ",", "1"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "1000", ",", "223034", ",", "0.04802`", ",", "11", ",", "1"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "2000", ",", "423252", ",", "0.088295`", ",", "11", ",", "1"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "2000", ",", "889372", ",", "0.125819`", ",", "10", ",", "1"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "3000", ",", "950022", ",", "0.149972`", ",", "10", ",", "1"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "3000", ",", "2001058", ",", "0.256741`", ",", "10", ",", "1"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "4000", ",", "1689062", ",", "0.270121`", ",", "11", ",", "1"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "4000", ",", "3555962", ",", "0.430178`", ",", "10", ",", "1"}],
     "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.5358795517644033`*^9, 3.535879855890244*^9, 
  3.535881181514864*^9, 3.535881821364496*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"withdensity", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"data", "[", 
          RowBox[{"[", "n", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], "*", 
       RowBox[{
        RowBox[{
         RowBox[{"data", "[", 
          RowBox[{"[", "n", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"data", "[", 
            RowBox[{"[", "n", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], ")"}]}]}], ",", 
      RowBox[{
       RowBox[{"data", "[", 
        RowBox[{"[", "n", "]"}], "]"}], "[", 
       RowBox[{"[", "4", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", "n", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"data", "[", 
                  RowBox[{"[", "n", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "^", "2"}], "//", "N"}], 
              ")"}]}], ")"}], "*", "10"}], "//", "Floor"}], ")"}], "/", 
        "10"}], "//", "N"}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"n", ",", "1", ",", 
      RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.535879511766716*^9, 3.535879537507285*^9}, {
  3.535879568861774*^9, 3.535879592459241*^9}, {3.535879630547316*^9, 
  3.5358796522925453`*^9}, {3.535879740388363*^9, 3.535879837843214*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"106342", ",", "0.036735`", ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"223034", ",", "0.04802`", ",", "0.2`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"423252", ",", "0.088295`", ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"889372", ",", "0.125819`", ",", "0.2`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"950022", ",", "0.149972`", ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2001058", ",", "0.256741`", ",", "0.2`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1689062", ",", "0.270121`", ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3555962", ",", "0.430178`", ",", "0.2`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7110505", ",", "0.794377`", ",", "0.2`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3797120", ",", "0.492455`", ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6745868", ",", "0.841319`", ",", "0.1`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.535879524427837*^9, 3.535879577601742*^9}, {
   3.5358796356920147`*^9, 3.535879652576621*^9}, {3.5358797618623667`*^9, 
   3.5358797710297813`*^9}, {3.535879802130677*^9, 3.535879855923843*^9}, 
   3.535881181548538*^9, 3.535881821389978*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"groupedByDensity", "=", 
  RowBox[{"Gather", "[", 
   RowBox[{"withdensity", ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"#1", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", 
      RowBox[{"#2", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "&"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.53587966537904*^9, 3.535879667476741*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"106342", ",", "0.036735`", ",", "0.1`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"423252", ",", "0.088295`", ",", "0.1`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"950022", ",", "0.149972`", ",", "0.1`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1689062", ",", "0.270121`", ",", "0.1`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3797120", ",", "0.492455`", ",", "0.1`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6745868", ",", "0.841319`", ",", "0.1`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"223034", ",", "0.04802`", ",", "0.2`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"889372", ",", "0.125819`", ",", "0.2`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2001058", ",", "0.256741`", ",", "0.2`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3555962", ",", "0.430178`", ",", "0.2`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7110505", ",", "0.794377`", ",", "0.2`"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.535879669634156*^9, 3.535879855949733*^9, 
  3.5358811815762787`*^9, 3.535881821412627*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"groupedByDensity", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.535879901544156*^9, 3.535879904288162*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"106342", ",", "0.036735`", ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"423252", ",", "0.088295`", ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"950022", ",", "0.149972`", ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1689062", ",", "0.270121`", ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3797120", ",", "0.492455`", ",", "0.1`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6745868", ",", "0.841319`", ",", "0.1`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.5358799045129423`*^9, 3.535881181583692*^9, 
  3.535881821432653*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"withoutDensity", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"groupedByDensity", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "j", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"groupedByDensity", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "j", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"groupedByDensity", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "groupedByDensity", "]"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5358795946725597`*^9, 3.535879595000431*^9}, {
  3.535879852578257*^9, 3.535880050913315*^9}, {3.5358804217884197`*^9, 
  3.535880429682457*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"106342", ",", "0.036735`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"423252", ",", "0.088295`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"950022", ",", "0.149972`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1689062", ",", "0.270121`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3797120", ",", "0.492455`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6745868", ",", "0.841319`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"223034", ",", "0.04802`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"889372", ",", "0.125819`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2001058", ",", "0.256741`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3555962", ",", "0.430178`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7110505", ",", "0.794377`"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.5358798559733267`*^9, 3.53587989250174*^9}, {
   3.535879948855043*^9, 3.535879981010652*^9}, {3.535880033529155*^9, 
   3.535880051334807*^9}, 3.535880430452669*^9, 3.5358811816131363`*^9, 
   3.5358818214558907`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"withoutDensity", ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"Mesh", "\[Rule]", "All"}], ",", 
   RowBox[{"PlotLegend", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<\[TildeTilde]0.1\>\"", ",", "\"\<\[TildeTilde]0.2\>\""}], 
     "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5358800567952623`*^9, 3.535880091922905*^9}, {
  3.535880284260765*^9, 3.535880308909878*^9}}],

Cell[BoxData[
 GraphicsBox[{InsetBox[
    GraphicsBox[
     GraphicsComplexBox[{{106342., 0.036735}, {423252., 0.088295}, {950022., 
      0.149972}, {1.689062*^6, 0.270121}, {3.79712*^6, 0.492455}, {
      6.745868*^6, 0.841319}, {223034., 0.04802}, {889372., 0.125819}, {
      2.001058*^6, 0.256741}, {3.555962*^6, 0.430178}, {7.110505*^6, 
      0.794377}}, {{{}, {}, 
        {Hue[0.67, 0.6, 0.6], LineBox[{1, 2, 3, 4, 5, 6}]}, 
        {Hue[0.9060679774997897, 0.6, 0.6], LineBox[{7, 8, 9, 10, 11}]}}, {
        {Hue[0.67, 0.6, 0.6], 
         PointBox[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11}]}, {}, {}, {}}}],
     AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
     Axes->True,
     AxesOrigin->{0, 0},
     DisplayFunction:>$DisplayFunction,
     FormatType->TraditionalForm,
     PlotRange->{{0., 7.110505*^6}, {0., 0.841319}},
     PlotRangeClipping->True,
     PlotRangePadding->{
       Scaled[0.02], 
       Scaled[0.02]}], {-1, -0.6180339887498948}, {
    Left, Bottom}, {2, 1.2360679774997896`}], GraphicsGroupBox[{
     {GrayLevel[0], 
      RectangleBox[{-1.15, -0.8680339887498949}, \
{-0.3499999999999999, -0.26803398874989476`}]}, 
     {GrayLevel[1], EdgeForm[{GrayLevel[0], Thickness[0.001]}], 
      GraphicsGroupBox[{
        RectangleBox[{-1.2, -0.8180339887498949}, \
{-0.3999999999999999, -0.21803398874989477`}], InsetBox[
         GraphicsBox[{{{InsetBox[
              GraphicsBox[{
                {Hue[0.9060679774997897, 0.6, 0.6], 
                 LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 0.08}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[TildeTilde]0.2\"\>", \
{1.2100000000000002`, 0.58}, {-1, 0}, Automatic, {1, 0}]}, {InsetBox[
              GraphicsBox[{
                {Hue[0.67, 0.6, 0.6], LineBox[{{0, 0.5}, {1, 0.5}}]}, {}},
               PlotRange->{{0, 1}, {0, 1}}], {0.08, 1.24}, {
              Left, Bottom}, {1, 1}], 
             InsetBox["\<\"\[TildeTilde]0.1\"\>", \
{1.2100000000000002`, 1.74}, {-1, 0}, Automatic, {1, 0}]}}, {}},
          AspectRatio->0.7500000000000001,
          FormatType->TraditionalForm,
          
          PlotRange->{{-0.1, 3.26}, {-0.1, 
           2.42}}], {-1.2, -0.8180339887498949}, {
         Left, Bottom}, {0.8, 0.6000000000000001}]}]}}]},
  AspectRatio->Automatic,
  Background->None,
  ColorOutput->Automatic,
  ImageSize->Automatic,
  PlotRange->All]], "Output",
 CellChangeTimes->{3.535880347041699*^9, 3.5358811832432823`*^9, 
  3.535881823107397*^9}]
}, Open  ]]
},
WindowSize->{638, 503},
WindowMargins->{{Automatic, 2}, {Automatic, -17}},
FrontEndVersion->"8.0 for Linux x86 (64-bit) (February 23, 2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 333, 7, 50, "Input"],
Cell[915, 31, 1589, 49, 221, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2541, 85, 1130, 35, 164, InheritFromParent],
Cell[3674, 122, 1176, 36, 164, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4887, 163, 1834, 52, 107, "Input"],
Cell[6724, 217, 1262, 29, 126, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8023, 251, 376, 10, 30, "Input"],
Cell[8402, 263, 1231, 31, 126, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9670, 299, 158, 3, 30, "Input"],
Cell[9831, 304, 660, 17, 69, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10528, 326, 1139, 31, 107, "Input"],
Cell[11670, 359, 1216, 33, 107, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12923, 397, 449, 10, 50, "Input"],
Cell[13375, 409, 2533, 56, 259, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
